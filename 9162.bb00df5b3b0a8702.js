"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9162],{9162:(k,u,s)=>{s.r(u),s.d(u,{TalePageModule:()=>w});var p=s(6814),g=s(95),l=s(3582),c=s(3044),t=s(6689),f=s(1269),h=s(6593);const m=["audioPlayer"];function x(i,r){1&i&&t._UZ(0,"div",20)}function v(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"Play"),t.qZA())}function T(i,r){1&i&&(t.TgZ(0,"span"),t._uU(1,"Pause"),t.qZA())}function y(i,r){if(1&i){const n=t.EpF();t.TgZ(0,"button",21),t.NdJ("click",function(){t.CHM(n);const o=t.oxw(2);return t.KtG(o.playPause())}),t.YNc(1,v,2,0,"span",22),t.YNc(2,T,2,0,"span",22),t.qZA()}if(2&i){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!n.isPlaying),t.xp6(1),t.Q6J("ngIf",n.isPlaying)}}function b(i,r){if(1&i&&(t.TgZ(0,"div",10),t.YNc(1,x,1,0,"div",11),t.TgZ(2,"div",12),t._UZ(3,"audio",13,14),t.TgZ(5,"div",15),t.YNc(6,y,3,2,"button",16),t.TgZ(7,"div",17),t._UZ(8,"div",18),t.qZA(),t.TgZ(9,"div",19)(10,"span"),t._uU(11),t.qZA(),t._uU(12," / "),t.TgZ(13,"span"),t._uU(14),t.qZA()()()()()),2&i){const n=t.oxw();t.ekj("loading",n.isLoading),t.xp6(1),t.Q6J("ngIf",n.isLoading),t.xp6(2),t.Q6J("src",n.audioLink,t.LSH),t.xp6(3),t.Q6J("ngIf",!n.isLoading),t.xp6(2),t.Udp("width",n.progress+"%"),t.xp6(3),t.Oqu(n.currentTime),t.xp6(3),t.Oqu(n.duration)}}const P=[{path:"",component:(()=>{var i;class r{constructor(e,o,a,d){this.route=e,this.httpService=o,this.sanitizer=a,this.cdr=d,this.id="1",this.tale={title:"undefined",author:{first_last:"undefined"},full_text:"undefined",bg_img:"https://pcvector.net/uploads/posts/2018-02/1517572511_bg-svg-gradient-min.png",grammar:[{phrase:"undefined",transcription:"undefined",translation:"undefined"}],video_src:"undefined"},this.segment_value="text",this.audioLink="https://sndup.net/"+this.tale.video_src+"/d",this.isPlaying=!1,this.currentTime="0:00",this.duration="0:00",this.progress=0,this.isLoading=!0,this.isAudio=!0,this.sanitizedFullText=""}ngAfterViewInit(){if(this.isAudio){const e=this.audioPlayer.nativeElement;e.addEventListener("timeupdate",this.updateTime.bind(this)),e.addEventListener("loadedmetadata",this.loadedMetadata.bind(this)),e.addEventListener("canplaythrough",this.canPlayThrough.bind(this))}}ngOnInit(){this.route.params.subscribe(e=>this.id=e.id),this.getTale()}getTale(){console.log(this.id),this.tale=this.httpService.getTaleData()[this.id],this.tale.full_text=`<div class="styled-content">${this.wrapWordsInDiv(this.tale.full_text,this.tale.grammar)}</div>`,console.log(this.tale.full_text),this.sanitizedFullText=this.sanitizer.bypassSecurityTrustHtml(this.tale.full_text),console.log(this.tale.full_text),console.log(this.tale.grammar),"no audio"==this.tale.video_src?(this.audioLink="https://sndup.net/qjvx/",this.isAudio=!1):(this.audioLink="https://sndup.net/"+this.tale.video_src+"/d",this.isAudio=!0),this.cdr.detectChanges()}wrapWordsInDiv(e,o){return o.forEach(a=>{const d=Math.random().toString(36).substring(2,9),A=new RegExp(`\\b${a.phrase}\\b`,"gi");e=e.replace(A,`<span id="${d}" class='highlighted-word'>${a.phrase}</span>\n          <ion-popover trigger="${d}" side="bottom" alignment="center" triggerAction="click">\n            <ng-template [ngTemplateOutlet]="popoverTemplate">\n              <ion-card>\n                <ion-content>\n                  <ion-title class="phrase">${a.phrase}</ion-title>\n                  <ion-title class="transcription">${a.transcription}</ion-title>\n                  <ion-title class="phrase">${a.translation}</ion-title>\n                </ion-content>\n              </ion-card>\n            </ng-template>\n          </ion-popover>`),console.log(e)}),e}playPause(){const e=this.audioPlayer.nativeElement;e.paused?(e.play(),this.isPlaying=!0):(e.pause(),this.isPlaying=!1)}updateTime(e){const o=this.audioPlayer.nativeElement,a=o.currentTime,d=o.duration;this.currentTime=this.formatTime(a),this.progress=a/d*100}loadedMetadata(e){this.duration=this.formatTime(this.audioPlayer.nativeElement.duration)}canPlayThrough(e){this.isLoading=!1}formatTime(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}segmentChanged(e){console.log(e.detail.value),this.segment_value=e.detail.value}}return(i=r).\u0275fac=function(e){return new(e||i)(t.Y36(c.gz),t.Y36(f.O),t.Y36(h.H7),t.Y36(t.sBO))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-tale"]],viewQuery:function(e,o){if(1&e&&t.Gf(m,5),2&e){let a;t.iGM(a=t.CRH())&&(o.audioPlayer=a.first)}},decls:17,vars:6,consts:[[3,"translucent"],["slot","start"],["defaultHref","/tales/morning"],[1,"background",3,"fullscreen"],[1,"card_floodfill"],["offset-md","3","size-md","6"],["class","audio-player-container",3,"loading",4,"ngIf"],[1,"styled-content"],[1,"title"],["slot","content",1,"ion-padding",3,"innerHTML"],[1,"audio-player-container"],["class","loader",4,"ngIf"],[1,"audio-player"],["id","audioPlayer",3,"src"],["audioPlayer",""],[1,"controls"],[3,"click",4,"ngIf"],[1,"progress-bar"],[1,"progress"],[1,"time"],[1,"loader"],[3,"click"],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA()()(),t.TgZ(6,"ion-content",3)(7,"body")(8,"ion-grid")(9,"div",4)(10,"ion-row")(11,"ion-col",5),t.YNc(12,b,15,9,"div",6),t.qZA()(),t.TgZ(13,"div",7)(14,"div",8),t._uU(15),t.qZA(),t._UZ(16,"div",9),t.qZA()()()()()),2&e&&(t.Q6J("translucent",!0),t.xp6(5),t.hij("",o.tale.title," "),t.xp6(1),t.Q6J("fullscreen",!0),t.xp6(6),t.Q6J("ngIf",o.isAudio),t.xp6(3),t.hij(" ",o.tale.title," "),t.xp6(1),t.Q6J("innerHTML",o.sanitizedFullText,t.oJD))},dependencies:[p.O5,l.Sm,l.wI,l.W2,l.jY,l.Gu,l.Nd,l.wd,l.sr,l.oU],styles:['@charset "UTF-8";body{background:radial-gradient(circle,rgb(243,233,211) 0%,rgb(251,224,176) 100%)}.audio-container-error{background-color:#fff;border-radius:10px;box-shadow:0 4px 8px #0000001a;padding:20px 40px;max-width:500px;text-align:center;border:1px solid #ddd}.audio-player-container{position:relative;border:2px solid #007bff;padding:10px;border-radius:10px;display:flex;justify-content:center;align-items:center}.audio-player-container.loading .audio-player{opacity:.5}.loader{position:absolute;width:40px;height:40px;border:4px solid #007bff;border-radius:50%;border-top:4px solid transparent;animation:spin 1s linear infinite}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.audio-player{display:flex;flex-direction:column;align-items:center;gap:10px}.audio-player .controls{display:flex;align-items:center;gap:10px}.audio-player .controls button{padding:5px 10px;background-color:#007bff;color:#fff;border:none;border-radius:5px;cursor:pointer}.audio-player .controls .progress-bar{width:200px;height:5px;background-color:#ddd;border-radius:5px;overflow:hidden}.audio-player .controls .progress-bar .progress{height:100%;background-color:#007bff;transition:width .1s}.audio-player .controls .time{font-size:14px;color:#333}.accordion-content,body{overflow-y:scroll}.phrase-container{display:flex;flex-direction:column}.phrase{font-size:1.2em;margin:0}.transcription{font-size:1em;margin:0;color:var(--ion-color-medium)}.footer{background-color:#f1f1f1;text-align:center;padding:20px}.footer p{margin:0;font-size:.9em;color:#000}.styled-content{padding:5px;margin:5px;line-height:1.5;color:navy;font-size:20px;background-color:#ddd;border-radius:15px;text-indent:30px}.highlighted-word{color:#8a2be2}.title{font-size:48px;color:#000;font-family:fantasy;text-align:center;margin-bottom:-50px;margin-top:10px}.left-column{width:50%;float:left;background-color:#add8e6}.right-column{width:50%;float:left;background-color:#f08080}\n',"\n    /* ion-content {\n      background-image: url(\"{{tale['bg_img']}}\");\n    } */\n  "],encapsulation:2}),r})()}];let _=(()=>{var i;class r{}return(i=r).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[c.Bz.forChild(P),c.Bz]}),r})();var Z=s(2898);let w=(()=>{var i;class r{}return(i=r).\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[p.ez,g.u5,l.Pc,_,Z.D]}),r})()}}]);